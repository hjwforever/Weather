{% load static %}
<!DOCTYPE html>
<html lang="zxx">
<head>
    <title>Six Single Dogs Weather</title>
    <meta charset="UTF-8">
    <meta name="description" content="天气预测">
    <meta name="keywords" content="天气预测,weather,predict">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 网页标签图片 -->
    <link href="{% static 'img/favicon.ico' %}" rel="shortcut icon"/>
    <!-- 网页背景资源包 -->
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i,700,700i" rel="stylesheet">
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/style.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/animate.css' %}"/>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- 图表echarts资源包 -->
    <script src="{% static 'echarts.min.js' %}"></script>
    <script>

    </script>

    <!-- hao123资源包 -->
    <noscript>
        <meta http-equiv="refresh" content="0; URL='/tianqi/?__noscript__-=1'"/>
    </noscript>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="always">
    <link rel="stylesheet" type="text/css" href="http://s1.hao123img.com/resource/fe/pkg/aio-eef856ab5.1fd5261cd.css"/>
    <link rel="stylesheet" type="text/css" href="http://s0.hao123img.com/resource/tianqi/pkg/aio-519f9ba.08a30c5.css"/>
    <link rel="stylesheet" type="text/css" href="http://s2.hao123img.com/resource/fe/pkg/aio-8155b5719.e2c46864a.css"/>
    <!-- 日程表资源包 -->
    <link rel="stylesheet" href="{% static 'css/documentation.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'css/jalendar.css' %}" type="text/css"/>
    <script type="text/javascript" src="{% static 'js/jquery-1.10.2.min.js' %}"></script><!--jQuery-->
    <script type="text/javascript" src="{% static 'js/jalendar.js' %}"></script>
    <script type="text/javascript">
        $(function () {
            $('#myId').jalendar({
                customDay: '2017/12/01',  // Format: Year/Month/Day
                color: '#ed145a', // Unlimited Colors
                lang: 'EN' // Format: English — 'EN', Türkçe — 'TR'
            });
            $('#myId2').jalendar({
                customDay: '2016/02/29',
                color: '#023447',
                lang: 'ES'
            });
            $('#myId3').jalendar();
        });







    </script>
    <script type="text/javascript">
        function showcity(str) {
            var xmlhttp;
            if (str == "") {
                document.getElementById("todayweather").innerHTML = "下拉选项空值异常";
                return;
            }
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    {#document.getElementById("todayweather").innerHTML = xmlhttp.responseText;#}
                    {#eval("var objResults =" + xmlhttp.responseText);#}
                    {#var obj = eval("("+xmlhttp.responseText+")");#}
                    {#var data1 = eval("("+obj+")");#}
                    {#var displaytext = "";#}
                    {#displaytext += data1.data +"<br>";#}
                    {#var finddiv = document.getElementById("todayweather");//寻找显示容器#}
                    {#finddiv.innerHTML = displaytext;//引用解析好了的数据#}
                    {#document.getElementById('todayweather').innerText= result ;#}

                    var jsonObj;
                    var s;
                    s = xmlhttp.responseText;
                    var myobj = eval(s);
                    city = '';
                    switch (myobj[0].fields.city) {
                        case 'bejing':
                            city = '北京';
                            break;
                        case 'zhengzhou':
                            city = '郑州';
                            break;
                        case 'longyan':
                            city = '龙岩';
                            break;
                        case 'tianjin':
                            city = '天津';
                            break;
                        case 'xiangyang':
                            city = '襄阳';
                            break;
                        case 'fengcheng':
                            city = '丰城';
                            break;
                        case 'hailar':
                            city = '海拉尔';
                            break;
                        default:
                            city = '北京';
                    }

                    var today_weather_msg=myobj[0].fields.weather+"&nbsp&nbsp&nbsp&nbsp"+ myobj[0].fields.tmin+"~"+myobj[0].fields.tmax+"℃";
                    var tomorrow_weather_msg=myobj[1].fields.weather;
                    var nexttomorrow_weather_msg=myobj[2].fields.weather;
                    var date_0_msg=myobj[3].fields.date+"&nbsp&nbsp&nbsp&nbsp"+ myobj[3].fields.tmin+"~"+myobj[3].fields.tmax+"℃";
                    var date_1_msg=myobj[4].fields.date+"&nbsp&nbsp&nbsp&nbsp"+ myobj[4].fields.tmin+"~"+myobj[4].fields.tmax+"℃";
                    var date_2_msg=myobj[5].fields.date+"&nbsp&nbsp&nbsp&nbsp"+ myobj[5].fields.tmin+"~"+myobj[5].fields.tmax+"℃";
                    var date_3_msg=myobj[6].fields.date+"&nbsp&nbsp&nbsp&nbsp"+ myobj[6].fields.tmin+"~"+myobj[6].fields.tmax+"℃";

                    document.getElementById("selectcity").innerHTML = city;
                    document.getElementById("today").innerHTML = myobj[0].fields.tavg;
                    document.getElementById("today_weather").innerHTML = today_weather_msg;
                    document.getElementById("tomorrow").innerHTML = myobj[1].fields.tmin+"~"+myobj[0].fields.tmax;
                    document.getElementById("tomorrow_weather").innerHTML = tomorrow_weather_msg;
                    document.getElementById("nexttomorrow").innerHTML = myobj[2].fields.tmin+"~"+myobj[0].fields.tmax;
                    document.getElementById("nexttomorrow_weather").innerHTML = nexttomorrow_weather_msg;
                    document.getElementById("date_0").innerHTML =date_0_msg;
                    document.getElementById("date_1").innerHTML = date_1_msg;
                    document.getElementById("date_2").innerHTML = date_2_msg;
                    document.getElementById("date_3").innerHTML = date_3_msg;
                    document.getElementById("date_0_weather").innerHTML = myobj[3].fields.weather;
                    document.getElementById("date_1_weather").innerHTML = myobj[4].fields.weather;
                    document.getElementById("date_2_weather").innerHTML = myobj[4].fields.weather;
                    document.getElementById("date_3_weather").innerHTML = myobj[5].fields.weather;
                }
            }
            xmlhttp.open("GET", "/app/selectcity?city=" + str, true);
            xmlhttp.send();
        }
    </script>
    <script type="text/javascript">
        function getcalendar(username) {
            var xmlhttp;
            if (username == "") {
                return;
            }
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var originaldata;
                    originaldata = xmlhttp.responseText;
                    var myobj = eval(originaldata);
                    alert(username);
                    {#var title = myobj[0].fields;#}
                    {#var isAllDay = $(this).parents('.add-new').find('.all-day fieldset').attr('data-type');#}
                    {#var isAllDayText = $(this).parents('.add-new').find('.all-day fieldset label').text();#}
                    {#var thisDay = $this.find('.day.this-month.selected').attr('data-date');#}
                    {#var time;#}
                    {#if (isAllDay == 'disabled') {time = hour + ':' + min;} else {time = isAllDayText;}#}
                }
            }
            {#$this.prepend(div('div', 'added-event').attr({#}
            {#        'data-date': thisDay,#}
            {#        'data-time': time,#}
            {#        'data-title': title,#}
            {#        'data-id': dataId#}
            {#    })#}
            {#);#}
            {#$this.find('.day.this-month.selected').prepend(#}
            {#    div('div', 'event-single').attr('data-id', dataId).append(#}
            {#        div('p', '').text(title),#}
            {#        div('div', 'details').append(#}
            {#            div('div', 'clock').text(time),#}
            {#            div('div', 'erase')#}
            {#        )#}
            {#    )#}
            {#);#}
            {#$this.find('.day').has('.event-single').addClass('have-event').prepend(div('i', ''));#}
            {#$this.find('.events-list').html($this.find('.day.this-month.selected .event-single').clone())#}
            {#$this.find('.events-list .event-single').eq(0).hide().slideDown();#}
            {#calcTotalDayAgain();#}
            {#calcScroll();#}
            {#// scrolltop after adding new event#}
            {#$this.find('.events-list').scrollTop(0);#}
            {#// form reset#}
            {#$this.find('.add-new > input[type="text"]').val(lAddEvent[settings.lang]).select();#}
            {#dataId++;#}
            xmlhttp.open("GET", "/app/getcalendar?name=" + username, true);
            xmlhttp.send();
        }
    </script>
</head>
<!-- body start -->
<body>
<!-- Page Preloder -->
<div id="preloder">
    <div class="loader"></div>
</div>
<!-- Page Preloder end -->
<!-- Header section -->
<header class="header-section">
    <div class="container">
        <!-- logo -->
        <a class="site-logo" href="{% url 'index' %}" style="padding-top: 0" title="返回首页">
            <img src="{% static 'img/favicon.ico' %}" alt="返回首页" height="40" width="40">
        </a>
        <a style="font-size: 40px;color: orange;padding-left: 20px" href="{% url 'index' %}" title="返回首页">Six-Single-Dogs</a>
        <div class="user-panel">
            {% if has_login %}
                <a href="{% url 'logout' %}" style="font-size: 20px;color: white">
                    {{ "登出" }}
                </a>
            {% else %}
                <a href="{% url 'login' %}" style="font-size: 20px;color: white">
                    {{ "登录" }}
                </a>
                <a href="{% url 'register' %}" style="color: white;font-size: 20px"> / 注册</a>
            {% endif %}
        </div>
        <!-- responsive -->
        <div class="nav-switch">
            <i class="fa fa-bars"></i>
        </div>
        <!-- site menu -->
        <nav class="main-menu">
            <ul>
                <li><a href="{% url 'index' %}" style="font-size: 20px;color: orange">首页</a></li>
                <li><a href="{% url 'history' %}" style="font-size: 20px;color: orange">历史天气</a></li>
            </ul>
        </nav>
    </div>
</header>
<!-- Header section end -->
<!-- hao123 section start -->
<div class="page-layer status-day">
    <div class="header-layer">
        <div class="weather-info-layer">
            <form action="{% url 'index' %}" method="GET" style="padding-top: 10px">
                {% if has_login %}
                    <span style="font-size: 25px;color: orange">欢迎您，{{ login_user_name }}</span>
                {% endif %}
                <label style="float: right">
                    <select id="choosecity" type="text" name="CITY"
                            onChange="showcity(this.value);changechart(this.value)"
                            style="width: auto;height: 27px;font-size: 25px;color: orange;background: none">
                        <option value="beijing" style="background-color: #FFEFD5" selected>北京</option>
                        <option value="zhengzhou" style="background-color: #FFEFD5">郑州</option>
                        <option value="longyan" style="background-color: #FFEFD5">龙岩</option>
                        <option value="tianjin" style="background-color: #FFEFD5">天津</option>
                        <option value="fengcheng" style="background-color: #FFEFD5">丰城</option>
                        <option value="xiangyang" style="background-color: #FFEFD5">襄阳</option>
                        <option value="hailar" style="background-color: #FFEFD5">海拉尔</option>
                    </select>
                </label>
            </form>
            <div class="weather-info-inner">
                <div class="real-time-box">
                    <div class="icon icon-w w-00"></div>
                    <div class="text"><span id="selectcity" style="font-size: 35px">北京</span><span class="label">&nbsp;今日天气</span>
                        <div class="temperature">
                            <span class="num" id="today"></span>
                            <span class="symbol">℃</span>
                        </div>
                        <div class="others">
                            <div class="line-1"><span id="today_weather">晴</span></div>
{#                            <div class="line-2"><span>PM2.5 : 74</span><span>气压 : 991</span><span>湿度 : 46</span></div>#}
                        </div>
                    </div>
                </div>
                <div class="forecast-box">
                    <div class="forecast-item">
                        <div class="info">
                            <div class="icon icon-w w-01"><i class="icon-date ming"></i></div>
                            <div class="temp" >
                                <span class="num" id="tomorrow"></span>
                                <span class="symbol">℃</span>
                            </div>
                        </div>
{#                        &nbsp;&nbsp;微风&nbsp;&nbsp;空气质量优#}
                        <div class="text"><span id="tomorrow_weather"></span></div>
{#                        <div class="text"><span>&nbsp;&nbsp;2&nbsp;&nbsp;空气质量优</span></div>#}
                    </div>
                    <div class="forecast-item last">
                        <div class="info">
                            <div class="icon icon-w w-08"><i class="icon-date hou"></i></div>
                            {#07 08 09 分别对应小雨中雨大雨#}
                            <div class="temp" >
                                <span class="num" id="nexttomorrow"></span>
                                <span class="symbol">℃</span>
                            </div>
                        </div>
                        <div class="text"><span id="nexttomorrow_weather"></span></div>
                    </div>
                </div>
                <div class="fifteen-days-box">
                    <div class="slide-layer">
                        <div class="slide-inner">
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_0"></span>
{#                                    {% if predict_queryset.0.date|date:'m' < 10 %}#}
{#                                        0{{ predict_queryset.0.date|date:'m' }}月#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.0.date|date:'m' }}月#}
{#                                    {% endif %}#}
{#                                    {% if predict_queryset.0.date|date:'d' < 10 %}#}
{#                                        0{{ predict_queryset.0.date|date:'d' }}日#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.0.date|date:'d' }}日#}
{#                                    {% endif %}#}
{#                                    &nbsp&nbsp{{ predict_queryset.0.tavg | floatformat:0 }}℃#}
                                </div>
                                <div class="weather"><span class="text" id="date_0_weather"></span><i class="icon-air icon-air-1"></i>
                                </div>
                                <div class="wind">无持续风向&nbsp;微风</div>
                            </div>
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_1"></span>
{#                                    {% if predict_queryset.1.date|date:'m' < 10 %}#}
{#                                        0{{ predict_queryset.1.date|date:'m' }}月#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.1.date|date:'m' }}月#}
{#                                    {% endif %}#}
{#                                    {% if predict_queryset.1.date.day < 10 %}#}
{#                                        0{{ predict_queryset.1.date.day }}日#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.1.date.day }}日#}
{#                                    {% endif %}#}
{#                                    &nbsp&nbsp{{ predict_queryset.1.tavg | floatformat:0 }}℃#}
                                </div>
                                <div class="weather"><span class="text" id="date_1_weather">多云</span><i class="icon-air icon-air-1"></i>
                                </div>
                                <div class="wind">无持续风向&nbsp;微风</div>
                            </div>
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_2"></span>
{#                                    {% if predict_queryset.2.date|date:'m' < 10 %}#}
{#                                        0{{ predict_queryset.2.date|date:'m' }}月#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.2.date|date:'m' }}月#}
{#                                    {% endif %}#}
{#                                    {% if predict_queryset.2.date|date:'d' < 10 %}#}
{#                                        0{{ predict_queryset.2.date|date:'d' }}日#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.2.date|date:'d' }}日#}
{#                                    {% endif %}#}
{#                                    &nbsp&nbsp{{ predict_queryset.2.tavg | floatformat:0 }}℃#}
                                </div>
                                <div class="weather"><span class="text" id="date_2_weather">多云</span><i class="icon-air icon-air-1"></i>
                                </div>
                                <div class="wind">无持续风向&nbsp;微风</div>
                            </div>
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_3"></span>
{#                                    {% if predict_queryset.3.date|date:'m' < 10 %}#}
{#                                        0{{ predict_queryset.3.date|date:'m' }}月#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.3.date|date:'m' }}月#}
{#                                    {% endif %}#}
{#                                    {% if predict_queryset.3.date|date:'d' < 10 %}#}
{#                                        0{{ predict_queryset.3.date|date:'d' }}日#}
{#                                    {% else %}#}
{#                                        {{ predict_queryset.3.date|date:'d' }}日#}
{#                                    {% endif %}#}
{#                                    &nbsp&nbsp{{ predict_queryset.3.tavg | floatformat:0 }}℃#}
                                </div>
                                <div class="weather"><span class="text" id="date_3_weather">多云</span><i class="icon-air icon-air-2"></i>
                                </div>
                                <div class="wind">东北风&nbsp;3-4级</div>
                            </div>
                        </div>
                        <a href="javascript:" class="prev"></a><a href="javascript:" class="next"></a></div>
                    <a class="label" href="//www.weather.com.cn/weather15d/101010100.shtml" target="_blank">
                        <div class="text">15日天气</div>
                    </a></div>
                <div class="data-source">数据来自中国天气网</div>
            </div>
        </div>
    </div>
</div>
<!-- hao123 section end -->
<!-- Latest news section -->
<div class="latest-news-section">
    <div class="ln-title" style="font-size: 30px;padding-top: 23px">当日天气</div>
    <div class="news-ticker">
        <div class="news-ticker-contant">
            <div class="nt-item" style="font-size: 20px"><span class="new" style="font-size: 20px" id="abeijing">北京</span>{{ queryset.values.0.tavg|floatformat:0}}℃&nbsp;晴&nbsp;空气质量优
            </div>
            <div class="nt-item" style="font-size: 20px"> <span class="strategy" style="font-size: 20px" id="atianjin">天津</span>{{ queryset.values.4.tavg|floatformat:0}}℃&nbsp;晴&nbsp;空气质量优
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="racing" style="font-size: 20px">湖北</span>35℃&nbsp;晴&nbsp;空气质量优
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="new" style="font-size: 20px">胡建</span>31℃&nbsp;晴&nbsp;空气质量优
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="strategy" style="font-size: 20px">河兰</span>22℃&nbsp;晴&nbsp;空气质量优
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="racing" style="font-size: 20px">内蒙古</span>35℃&nbsp;晴&nbsp;空气质量优
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="strategy" style="font-size: 20px">江西</span>22℃&nbsp;晴&nbsp;空气质量优
            </div>
        </div>
    </div>
</div>
<!-- Latest news section end -->
<!-- ECharts图表 -->
<!--为ECharts准备一个具备大小的Dom-->
<div id="main" style="background:url({% static 'img/pattern.png' %});width: 100%;height: 80%;"></div>
<script type="text/javascript">
    //获取数据
    var city = "";
    var xarr = [];
    var yarr = [];
    var tenyearx = [];
    var tenyeartmax = [];
    var tenyeartmin = [];
    var tenyeartavg = [];

    function changechart(str) {
        xarr = [];
        yarr = [];
        tenyearx = [];
        tenyeartmax = [];
        tenyeartmin = [];
        tenyeartavg = [];

        var xmlhttp;
        if (str == "") {
            alert("下拉选项空值异常");
            return;
        }
        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var jsonObj;
                var s;

                s = xmlhttp.responseText;
                {#s=s.substring(1,s.length-1)#}
                {#                    alert("ok")#}
                {#                    alert(s);#}
                var myobj = eval(s);
                {#                    alert(predict_queryset);#}
                var currentDateLong = new Date('{{ predict_queryset.0.date|safe }}'.replace(new RegExp("-", "gm"), "/")).getTime();
                {#                    alert('{{ predict_queryset.0.date|safe }}'+"   "+currentDateLong);#}
                {#                    xarr.push('{{ queryset.0.date|safe }}');#}
                {#                    yarr.push({{ queryset.0.tavg|safe }});#}
                for (i = 0; i < myobj.length; i++) {
                    var DateLong = new Date(myobj[i].fields.date.replace(new RegExp("-", "gm"), "/")).getTime()
                    {#                        alert(myobj[i].fields.date+"   "+DateLong);#}
                    if (DateLong <= currentDateLong) {
                        tenyearx.push(myobj[i].fields.date);
                        tenyeartmax.push(myobj[i].fields.tmax);
                        tenyeartmin.push(myobj[i].fields.tmin);
                        tenyeartavg.push(myobj[i].fields.tavg);
                    }
                    {#                       if( DateLong == currentDateLong ){#}
                    {#                            alert("==");#}
                    {#                            xarr.push(myobj[i].fields.date);#}
                    {#                            yarr.push(parseInt(myobj[i].fields.tavg));#}
                    {#                           }#}
                    if (DateLong >= currentDateLong) {
                        {#                            alert(i);#}
                        xarr.push(myobj[i].fields.date);
                        yarr.push(parseInt(myobj[i].fields.tavg));
                    }
                }

                // 基于准备好的dom，初始化echarts实例
                var myChart = echarts.init(document.getElementById('main'));
                //获取当前城市名
                var obj = document.getElementById("choosecity");
                var city = obj.options[obj.selectedIndex].value;
                {#    alert(city);#}
                // 指定图表的配置项和数据
                var colors = ['red', '#5793f3', '#ffb320', 'orange', 'white', 'pink'];


                {#    for(i=0;i< 10 ;i++){#}
                {#        {{ everyyeartodayhistory }}#}
                {#	}#}
                var option = {
                    baseOption: {
                        timeline: {
                            axisType: 'category',
                            // realtime: false,
                            // loop: false,
                            autoPlay: true,
                            // currentIndex: 2,
                            playInterval: 5000,
                            // controlStyle: {
                            //     position: 'left'
                            // },
                            lineStyle: {
                                color: colors[0],
                            },
                            controlStyle: {
                                color: colors[0],
                                borderColor: colors[0],
                                borderWidth: 2,
                            },
                            label: {
                                color: 'yellow',
                            },
                            data: [
                                '未来一周',
                                {
                                    value: '近十年同一天',
                                    {#                    tooltip: {#}
                                    {#                        formatter: '{b} 部分数据缺失！'#}
                                    {#                    },#}
                                    symbol: 'diamond',
                                    symbolSize: 20
                                },
                            ],
                            // label: {
                            //     formatter : function(s) {
                            //         return (new Date(s)).getFullYear();
                            //     }
                            // }
                        },
                        title: {
                            left: '10%',
                            top: '1%',
                            {#            fontsize: 3,#}
                            {#            subtextStyle: {#}
                            {#                color: 'green',//'white'#}
                            {#                },#}
                            {#            subtext: '数据来自国家统计局'#}
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross'
                            },

                            right: '20%',
                            top: '3%',
                        },
                        calculable: true,
                        grid: {
                            left: '8%',
                            right: '8%',
                            bottom: '10%',
                            containLabel: true
                        },
                        toolbox: {
                            color: colors[0],
                            show: true,
                            right: '10%',
                            top: '3%',
                            feature: {
                                dataZoom: {
                                    yAxisIndex: 'none'
                                },
                                dataView: {readOnly: false},
                                {#                dataView: {#}
                                {#                // 数据视图#}
                                {#                optionToContent: (opt) => {#}
                                {#                    var axisData = opt.xAxis[0].data;#}
                                {#                    var series = opt.series;#}
                                {#                    var table = `<div class="echartstableview"><table style="width:100%;text-align:center">#}
                                {#                                    <thead><tr><th>时间</th>`;#}
                                {#                    series.forEach(( element, index) => {#}
                                {#                        table += `<th>${element.name}</th>`;#}
                                {#                    })#}
                                {#                    table += `</tr></thead><tbody>`;#}
                                {#                    axisData.forEach(( date, index) => {#}
                                {#                        table += `<tr><td>${date}</td>`;#}
                                {#                        series.forEach(( series_, index_) => {#}
                                {#                            table += `<td>${series_.data[index]}</td>`;#}
                                {#                        })  #}
                                {#                        table += `</tr>`;#}
                                {#                    })#}
                                {#                    table += '</tbody></table></div>';#}
                                {#                    return table;#}
                                {#                },#}
                                magicType: {type: ['line', 'bar']},
                                restore: {},
                                saveAsImage: {},
                            },
                            iconStyle: {
                                normal: {
                                    color: colors[5],//设置颜色
                                }
                            }
                        },
                        xAxis: [
                            {
                                'type': 'category',
                                'axisLabel': {
                                    {#                        'interval': 0,#}
                                    onZero: false,
                                },
                                splitLine: {show: false}
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value',
                                boundaryGap: false,
                                axisTick: {
                                    alignWithLabel: true
                                },
                                axisLine: {
                                    onZero: false,
                                    lineStyle: {
                                        color: colors[2]
                                    }
                                },
                                min: function (value) {
                                    return value.min - 10;
                                },
                                max: function (value) {
                                    return value.max + 10;
                                }
                            }
                        ],
                    },
                    options: [
                        {
                            legend: {
                                top: '3%',
                                color: colors[2],
                                textStyle: {
                                    fontSize: 18,
                                    color: colors[2]
                                },
                                data: ['平均温度'],
                                selected: {
                                    '最高温度': false, '最低温度': false,
                                },
                            },
                            title: {
                                text: '未来一周',
                                textStyle: {
                                    color: colors[2],
                                },
                            },
                            xAxis: [
                                {
                                    'data': xarr,
                                    {#                         [#}
                                    {#                            "{{ queryset.0.date }}",#}
                                    {#                            {% for row in predict_queryset %}#}
                                    {#                                "{{ row.date }}",#}
                                    {#                            {% endfor %}#}
                                    {#                        ],#}
                                    axisLine: {
                                        lineStyle: {
                                            color: colors[2]
                                        }
                                    },
                                }
                            ],
                            yAxis: [
                                {
                                    axisLine: {
                                        onZero: false,
                                        lineStyle: {
                                            color: colors[2]
                                        }
                                    },
                                }
                            ],
                            series: [
                                {
                                    name: '最高温度',
                                    type: 'line',
                                }, {
                                    name: '平均温度',
                                    type: 'line',
                                    smooth: true,
                                    color: colors[2],
                                    lineStyle: {
                                        color: colors[2],
                                        width: 4,
                                    },
                                    data: yarr,
                                    {#                        ["{{ queryset.0.tavg | floatformat:0 }}",#}
                                    {#                            {% for row in predict_queryset %}#}
                                    {#                                "{{ row.tavg | floatformat:0}}",#}
                                    {#                            {% endfor %}#}
                                    {#                        ],#}
                                },
                                {
                                    name: '最低温度',
                                    type: 'line',
                                },

                            ]
                        },
                        {
                            legend: {
                                top: '3%',
                                color: colors[1],
                                textStyle: {
                                    fontSize: 18,
                                    color: colors[1]
                                },
                                data: ['最高温度', '平均温度', '最低温度'],
                                selected: {
                                    '最高温度': true, '最低温度': true, '平均温度': true,
                                },
                            },
                            title: {
                                text: '近10年同一天',
                                textStyle: {
                                    color: colors[1],
                                },
                            },
                            xAxis: [
                                {
                                    'data': tenyearx,
                                    axisLine: {
                                        lineStyle: {
                                            color: colors[1]
                                        }
                                    },
                                }
                            ],
                            yAxis: [
                                {
                                    axisLine: {
                                        onZero: false,
                                        lineStyle: {
                                            color: colors[1]
                                        }
                                    },
                                }
                            ],
                            series: [
                                {
                                    name: '最高温度',
                                    type: 'line',
                                    color: colors[0],
                                    lineStyle: {
                                        color: colors[0],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: tenyeartmax,
                                },
                                {
                                    name: '最低温度',
                                    type: 'line',
                                    color: colors[1],
                                    lineStyle: {
                                        color: colors[1],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: tenyeartmin,
                                },
                                {
                                    name: '平均温度',
                                    type: 'line',
                                    color: colors[2],
                                    lineStyle: {
                                        color: colors[2],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: tenyeartavg,
                                },
                            ]
                        },

                    ]
                };
      // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('main'));
    //获取当前城市名
    var obj = document.getElementById("choosecity");
    var city = obj.options[obj.selectedIndex].value;
    var colors = ['red', '#5793f3', '#ffb320', 'orange', 'white', 'pink'];
    var option = {
        baseOption: {
            timeline: {
                axisType: 'category',
                autoPlay: true,
                // currentIndex: 2,
                playInterval: 5000,
                lineStyle: {
                    color: colors[0],
                },
                controlStyle: {
                    color: colors[0],
                    borderColor: colors[0],
                    borderWidth: 2,
                },
                label: {
                    color: 'yellow',
                },
                data: [
                    '未来一周',
                    {
                        value: '近十年同一天',
                        symbol: 'diamond',
                        symbolSize: 20
                    },
                ],
            },
            title: {
                left: '10%',
                top: '1%',
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                },
                right: '20%',
                top: '3%',
            },
            calculable: true,
            grid: {
                left: '8%',
                right: '8%',
                bottom: '10%',
                containLabel: true
            },
            toolbox: {
                color: colors[0],
                show: true,
                right: '10%',
                top: '3%',
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: {readOnly: false},
                    {#                dataView: {#}
                    {#                // 数据视图#}
                    {#                optionToContent: (opt) => {#}
                    {#                    var axisData = opt.xAxis[0].data;#}
                    {#                    var series = opt.series;#}
                    {#                    var table = `<div class="echartstableview"><table style="width:100%;text-align:center">#}
                    {#                                    <thead><tr><th>时间</th>`;#}
                    {#                    series.forEach(( element, index) => {#}
                    {#                        table += `<th>${element.name}</th>`;#}
                    {#                    })#}
                    {#                    table += `</tr></thead><tbody>`;#}
                    {#                    axisData.forEach(( date, index) => {#}
                    {#                        table += `<tr><td>${date}</td>`;#}
                    {#                        series.forEach(( series_, index_) => {#}
                    {#                            table += `<td>${series_.data[index]}</td>`;#}
                    {#                        })  #}
                    {#                        table += `</tr>`;#}
                    {#                    })#}
                    {#                    table += '</tbody></table></div>';#}
                    {#                    return table;#}
                    {#                },#}
                    magicType: {type: ['line', 'bar']},
                    restore: {},
                    saveAsImage: {},
                },
                iconStyle: {
                    normal: {
                        color: colors[5],//设置颜色
                    }
                }
            },
            xAxis: [
                {
                    'type': 'category',
                    'axisLabel': {
{#                        'interval': 0,#}
                        onZero: false,
                    },
                    splitLine: {show: false}
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    boundaryGap: false,
                    axisTick: {
                        alignWithLabel: true
                    },
                    axisLine: {
                        onZero: false,
                        lineStyle: {
                            color: colors[2]
                        }
                    },
                    min: function (value) {
                        return value.min - 10;
                    },
                    max: function (value) {
                        return value.max + 10;
                    }
                }
            ],
        },
        options: [
            {
                legend: {
                    top: '3%',
                    color: colors[2],
                    textStyle: {
                        fontSize: 18,
                        color: colors[2]
                    },
                    data: ['平均温度'],
                    selected: {
                        '最高温度': false, '最低温度': false,
                    },
                },
                title: {
                    text: '未来一周',
                    textStyle: {
                        color: colors[2],
                    },
                },
                xAxis: [
                    {
                        'data':xarr,
                        axisLine: {
                            lineStyle: {
                                color: colors[2]
                            }
                        },
                    }
                ],
                yAxis: [
                    {
                        axisLine: {
                            onZero: false,
                            lineStyle: {
                                color: colors[2]
                            }
                        },
                    }
                ],
                series: [
                    {
                        name: '最高温度',
                        type: 'line',
                    }, {
                        name: '平均温度',
                        type: 'line',
                        smooth: true,
                        color: colors[2],
                        lineStyle: {
                            color: colors[2],
                            width: 4,
                        },
                        data: yarr,
                    },
                    {
                        name: '最低温度',
                        type: 'line',
                    },

                ]
            },
            {
                legend: {
                    top: '3%',
                    color: colors[1],
                    textStyle: {
                        fontSize: 18,
                        color: colors[1]
                    },
                    data: ['最高温度', '平均温度', '最低温度'],
                    selected: {
                        '最高温度': true, '最低温度': true, '平均温度': true,
                    },
                },
                title: {
                    text: '近10年同一天',
                    textStyle: {
                        color: colors[1],
                    },
                },
                xAxis: [
                    {
                        'data': tenyearx,
                        axisLine: {
                            lineStyle: {
                                color: colors[1]
                            }
                        },
                    }
                ],
                yAxis: [
                    {
                        axisLine: {
                            onZero: false,
                            lineStyle: {
                                color: colors[1]
                            }
                        },
                    }
                ],
                series: [
                    {
                        name: '最高温度',
                        type: 'line',
                        color: colors[0],
                        lineStyle: {
                            color: colors[0],
                            width: 4,
                        },
                        smooth: true,
                        data: tenyeartmax,
                    },
                    {
                        name: '最低温度',
                        type: 'line',
                        color: colors[1],
                        lineStyle: {
                            color: colors[1],
                            width: 4,
                        },
                        smooth: true,
                        data:tenyeartmin,
                    },
                    {
                        name: '平均温度',
                        type: 'line',
                        color: colors[2],
                        lineStyle: {
                            color: colors[2],
                            width: 4,
                        },
                        smooth: true,
                        data: tenyeartavg,
                    },
                ]
            },

                    ]
                };

                // 使用刚指定的配置项和数据显示图表。
                myChart.setOption(option);

            }
        }
        xmlhttp.open("GET", "/app/changechart?city=" + str, true);
        xmlhttp.send();
    }
</script>
<!-- ECharts图表 end -->
<!-- 日程表 -->
<article style="background: url({% static 'img/pattern.png' %})">
    <p style="font-size: 40px;color: orange;text-align: center;"><b>日程表</b></p>
    <div id="myId3" class="jalendar mid" style="width: 420px;" >
        {#        <div class="added-event" data-date="16/8/2013" data-time="20:45" data-title="Tarkan İstanbul Concert on Harbiye Açık Hava Tiyatrosu"></div>#}
        {#        <div class="added-event" data-date="17/8/2013" data-time="21:00"#}
        {#             data-title="CodeCanyon İstanbul Meeting on Starbucks, Kadıköy"></div>#}
        {#        <div class="added-event" data-date="17/8/2013" data-time="22:00"#}
        {#             data-title="Front-End Design and Javascript Conferance on Haliç Kongre Merkezi"></div>#}
        {#        <div class="added-event" data-date="17/12/2017" data-time="22:00" data-title="Lorem ipsum dolor sit amet"></div>#}
    </div>
</article>
<!-- 日程表 end -->
<!-- Footer top section -->
<section class="footer-top-section">
    <p style="text-align: center;color: #ffa500;font-size: 50px">Six-Single-Dogs</p>
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-6">
                <div class="footer-widget">
                    <h4 class="fw-title" style="font-size: 20px">小组程猿</h4>
                    <div class="top-comment">
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/1.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">胡江浩</a> <span style="font-size: 15px">单身待嫁</span>
                                </p>
                                <div class="tc-date">May&nbsp;3&nbsp;,2000</div>
                            </div>
                        </div>
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/2.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">陈付鑫</a> <span style="font-size: 15px">游戏狂魔</span>
                                </p>
                                <div class="tc-date">February&nbsp;29&nbsp;,2000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="footer-widget">
                    <h4 class="fw-title" style="font-size: 20px">小组程猿</h4>
                    <div class="top-comment">
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/3.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">陈庆洋</a> <span style="font-size: 15px">天才少年</span>
                                </p>
                                <div class="tc-date">May&nbsp;14&nbsp;,1999</div>
                            </div>
                        </div>
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/4.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">邓硕</a> <span style="font-size: 15px">内蒙大汉</span>
                                </p>
                                <div class="tc-date">July&nbsp;18&nbsp;,2000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="footer-widget">
                    <h4 class="fw-title" style="font-size: 20px">小组程猿</h4>
                    <div class="top-comment">
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/5.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">黄俊雯</a> <span style="font-size: 15px">快乐小伙</span>
                                </p>
                                <div class="tc-date">October&nbsp;29&nbsp;,2000</div>
                            </div>
                        </div>
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/6.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">黄琳棠</a> <span style="font-size: 15px">大龄剩男</span>
                                </p>
                                <div class="tc-date">May&nbsp;18&nbsp;,2000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Footer top section end -->
<!-- Footer section -->
<footer class="footer-section">
    <div class="container">
        <ul class="footer-menu">
            <li><a href="{% url 'index' %}">首页</a></li>
            <li><a href="{% url 'history' %}">历史天气</a></li>
        </ul>
        <p class="copyright"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear().toString());</script>
            All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a
                    href="https://colorlib.com" target="_blank">Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
        </p>
    </div>
</footer>
<!-- Footer section end -->


<!--====== Javascripts & Jquery ======-->
<script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<script src="{% static 'js/jquery.marquee.min.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>
</body>
<script>
    var obj = document.getElementById("choosecity");
    window.onload = showcity(obj.options[obj.selectedIndex].value);
    window.onload = changechart(obj.options[obj.selectedIndex].value);
    window.onload = getcalendar('{{ login_user_name }}');
</script>
</html>