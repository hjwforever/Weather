{% load static %}
<!DOCTYPE html>
<html lang="zxx">
<head>
    <title>Six Single Dogs Weather</title>
    <meta charset="UTF-8">
    <meta name="description" content="天气预测">
    <meta name="keywords" content="天气预测,weather,predict">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 网页标签图片 -->
    <link href="{% static 'img/favicon.ico' %}" rel="shortcut icon"/>
    <!-- 网页背景资源包 -->
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i,700,700i" rel="stylesheet">
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/style.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/animate.css' %}"/>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- 图表echarts资源包 -->
    <script src="{% static 'echarts.min.js' %}"></script>
    <script>

    </script>

    <!-- hao123资源包 -->
    <noscript>
        <meta http-equiv="refresh" content="0; URL='/tianqi/?__noscript__-=1'"/>
    </noscript>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="always">
    <link rel="stylesheet" type="text/css" href="http://s1.hao123img.com/resource/fe/pkg/aio-eef856ab5.1fd5261cd.css"/>
    <link rel="stylesheet" type="text/css" href="http://s0.hao123img.com/resource/tianqi/pkg/aio-519f9ba.08a30c5.css"/>
    <link rel="stylesheet" type="text/css" href="http://s2.hao123img.com/resource/fe/pkg/aio-8155b5719.e2c46864a.css"/>
    <!-- 日程表资源包 -->
    <link rel="stylesheet" href="{% static 'css/documentation.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'css/jalendar.css' %}" type="text/css"/>
    <script type="text/javascript" src="{% static 'js/jquery-1.10.2.min.js' %}"></script><!--jQuery-->
    <script type="text/javascript" src="{% static 'js/jalendar.js' %}"></script>
    <script type="text/javascript">
        $(function () {
            $('#myId').jalendar({
                customDay: '2017/12/01',  // Format: Year/Month/Day
                color: '#ed145a', // Unlimited Colors
                lang: 'EN' // Format: English — 'EN', Türkçe — 'TR'
            });
            $('#myId2').jalendar({
                customDay: '2016/02/29',
                color: '#023447',
                lang: 'ES'
            });
            $('#myId3').jalendar();
        });


    </script>
    <script>
        function transfercity(str) {
            switch (str) {
                case 'bejing':
                    return '北京';
                case 'zhengzhou':
                    return '郑州';
                case 'longyan':
                    return '龙岩';
                case 'tianjin':
                    return '天津';
                case 'xiangyang':
                    return '襄阳';
                case 'fengcheng':
                    return '丰城';
                case 'hailar':
                    return '海拉尔';
                default:
                    return '北京';
            }
        }

        function getcityname(object) {
            return transfercity(object.city);
        }

        function getcityweather(object) {
            return object.weather.toString();
        }
    </script>
    <script type="text/javascript">
        function showcity(str) {
            var xmlhttp;
            if (str == "") {
                document.getElementById("todayweather").innerHTML = "下拉选项空值异常";
                return;
            }
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    {#document.getElementById("todayweather").innerHTML = xmlhttp.responseText;#}
                    {#eval("var objResults =" + xmlhttp.responseText);#}
                    {#var obj = eval("("+xmlhttp.responseText+")");#}
                    {#var data1 = eval("("+obj+")");#}
                    {#var displaytext = "";#}
                    {#displaytext += data1.data +"<br>";#}
                    {#var finddiv = document.getElementById("todayweather");//寻找显示容器#}
                    {#finddiv.innerHTML = displaytext;//引用解析好了的数据#}
                    {#document.getElementById('todayweather').innerText= result ;#}

                    var jsonObj;
                    var s;
                    s = xmlhttp.responseText;
                    var myobj = eval(s);
                    city = getcityname(myobj[0].fields);
                    var today_weather_msg = myobj[0].fields.weather + "&nbsp&nbsp&nbsp&nbsp" + myobj[0].fields.tmin + " / " + myobj[0].fields.tmax + "℃";
                    var tomorrow_weather_msg = myobj[1].fields.weather;
                    var nexttomorrow_weather_msg = myobj[2].fields.weather;
                    var date_0_msg = myobj[3].fields.date + "&nbsp&nbsp&nbsp" + myobj[3].fields.tmin + " / " + myobj[3].fields.tmax + "℃";
                    var date_1_msg = myobj[4].fields.date + "&nbsp&nbsp&nbsp" + myobj[4].fields.tmin + " / " + myobj[4].fields.tmax + "℃";
                    var date_2_msg = myobj[5].fields.date + "&nbsp&nbsp&nbsp" + myobj[5].fields.tmin + " / " + myobj[5].fields.tmax + "℃";
                    if (myobj.length>6){
                        var date_3_msg = myobj[6].fields.date + "&nbsp&nbsp&nbsp" + myobj[6].fields.tmin + " / " + myobj[6].fields.tmax + "℃";
                    }else{
                        var date_3_msg ='预测中...'
                    }

                    document.getElementById("selectcity").innerHTML = city;
                    document.getElementById("today").innerHTML = myobj[0].fields.tavg;
                    document.getElementById("today_weather").innerHTML = today_weather_msg;
                    document.getElementById("tomorrow").innerHTML = myobj[1].fields.tmin + " / " + myobj[0].fields.tmax;
                    document.getElementById("tomorrow_weather").innerHTML = tomorrow_weather_msg;
                    document.getElementById("nexttomorrow").innerHTML = myobj[2].fields.tmin + " / " + myobj[0].fields.tmax;
                    document.getElementById("nexttomorrow_weather").innerHTML = nexttomorrow_weather_msg;
                    document.getElementById("date_0").innerHTML = date_0_msg;
                    document.getElementById("date_1").innerHTML = date_1_msg;
                    document.getElementById("date_2").innerHTML = date_2_msg;
                    document.getElementById("date_3").innerHTML = date_3_msg;
                    document.getElementById("date_0_weather").innerHTML = myobj[3].fields.weather;
                    document.getElementById("date_1_weather").innerHTML = myobj[4].fields.weather;
                    document.getElementById("date_2_weather").innerHTML = myobj[5].fields.weather;
                    if (myobj.length>6){
                        document.getElementById("date_3_weather").innerHTML = myobj[6].fields.weather;
                    }else{
                        document.getElementById("date_3_weather").innerHTML = '预测中...';
                    }

                    {#$(".todayicon").removeClass("todayicon");#}
                    {#$(".todayicon").attr("class","icon icon-w w-01")#}
                    var icon = document.getElementById("todayicon");
                    var icon1 = document.getElementById("tomorrowicon");
                    var icon2 = document.getElementById("nexttomorrowicon");
                    {#图标一#}
                    if (myobj[0].fields.weather.indexOf("多") != -1) {
                        icon.className = "icon icon-w w-01";
                    } else if (myobj[0].fields.weather.indexOf("晴") != -1) {
                        icon.className = "icon icon-w w-00";
                    } else if (myobj[0].fields.weather.indexOf("雷") != -1) {
                        icon.className = "icon icon-w w-05";
                    } else if (myobj[0].fields.weather.indexOf("暴") != -1) {
                        icon.className = "icon icon-w w-11";
                    } else if (myobj[0].fields.weather.indexOf("大") != -1) {
                        icon.className = "icon icon-w w-10";
                    } else if (myobj[0].fields.weather.indexOf("中") != -1) {
                        icon.className = "icon icon-w w-08";
                    } else if (myobj[0].fields.weather.indexOf("小") != -1) {
                        icon.className = "icon icon-w w-07";
                    } else if (myobj[0].fields.weather.indexOf("阴") != -1) {
                        icon.className = "icon icon-w w-02";
                    }

                    {#图标二#}
                    if (myobj[1].fields.weather.indexOf("多") != -1) {
                        icon1.className = "icon icon-w w-01";
                    } else if (myobj[1].fields.weather.indexOf("晴") != -1) {
                        icon1.className = "icon icon-w w-00";
                    } else if (myobj[1].fields.weather.indexOf("雷") != -1) {
                        icon1.className = "icon icon-w w-05";
                    } else if (myobj[1].fields.weather.indexOf("暴") != -1) {
                        icon1.className = "icon icon-w w-11";
                    } else if (myobj[1].fields.weather.indexOf("大") != -1) {
                        icon1.className = "icon icon-w w-10";
                    } else if (myobj[1].fields.weather.indexOf("中") != -1) {
                        icon1.className = "icon icon-w w-08";
                    } else if (myobj[1].fields.weather.indexOf("小") != -1) {
                        icon1.className = "icon icon-w w-07";
                    } else if (myobj[1].fields.weather.indexOf("阴") != -1) {
                        icon1.className = "icon icon-w w-02";
                    }

                    {#图标三#}
                    if (myobj[2].fields.weather.indexOf("多") != -1) {
                        icon2.className = "icon icon-w w-01";
                    } else if (myobj[2].fields.weather.indexOf("晴") != -1) {
                        icon2.className = "icon icon-w w-00";
                    } else if (myobj[2].fields.weather.indexOf("雷") != -1) {
                        icon2.className = "icon icon-w w-05";
                    } else if (myobj[2].fields.weather.indexOf("暴") != -1) {
                        icon2.className = "icon icon-w w-11";
                    } else if (myobj[2].fields.weather.indexOf("大") != -1) {
                        icon2.className = "icon icon-w w-10";
                    } else if (myobj[2].fields.weather.indexOf("中") != -1) {
                        icon2.className = "icon icon-w w-08";
                    } else if (myobj[2].fields.weather.indexOf("小") != -1) {
                        icon2.className = "icon icon-w w-07";
                    } else if (myobj[2].fields.weather.indexOf("阴") != -1) {
                        icon2.className = "icon icon-w w-02";
                    }

                    var wurl = document.getElementById("weather_url");
                    if(myobj[0].fields.city=='beijing'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101010100.shtml#input";
                    }else if(myobj[0].fields.city=='tianjin'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101030100.shtml#input";
                    }else if(myobj[0].fields.city=='fengcheng'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101240510.shtml#input";
                    }else if(myobj[0].fields.city=='hailar'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101081001.shtml#input";
                    }else if(myobj[0].fields.city=='longyan'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101230701.shtml#input";
                    }else if(myobj[0].fields.city=='zhengzhou'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101180101.shtml#input";
                    }else if(myobj[0].fields.city=='xiangyang'){
                        wurl.href = "http://www.weather.com.cn/weather1d/101200201.shtml#input";
                    }
                }
            }
            xmlhttp.open("GET", "/app/selectcity?city=" + str, true);
            xmlhttp.send();
        }
    </script>
    <script type="text/javascript">
        function getcalendar(username) {
            var xmlhttp;
            if (username === "") {
                return;
            }
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var originaldata;
                    originaldata = xmlhttp.responseText;
                    var myobj = eval(originaldata);
                    initCalendar(myobj);
                }
            }
            xmlhttp.open("GET", "/app/getcalendar?name=" + username, true);
            xmlhttp.send();
        }
    </script>
    <script>
        function addcalendar(time, title, isallday) {
            var xmlhttp;
            var name = '{{ login_user_name }}';
            if (name === "") {
                alert("添加失败，请登录");
                self.location="{% url 'login' %}";
            }
            if (title === "") {
                title = "一件事儿";
            }
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var originaldata = xmlhttp.responseText;
                    var isOK = eval(originaldata);
                    if (isOK !== "ok") {
                        alert("添加失败！");
                    }
                }
            }
            xmlhttp.open("GET", "/app/addcalendar?time=" + time + "&name=" + name + "&title=" + title + "&isAllDay=" + isallday, true);
            xmlhttp.send();
        }

        function deletecalendar(time, title, isallday) {
            var xmlhttp;
            var name = '{{ login_user_name }}';
            if (name === "") {
                alert("添加失败，请登录");
                self.location="{% url 'login' %}";
            }
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var originaldata = xmlhttp.responseText;
                    var isOK = eval(originaldata);
                    if (isOK !== "ok") {
                        alert("删除失败！");
                    }
                }
            }
            xmlhttp.open("GET", "/app/deletecalendar?time=" + time + "&name=" + name + "&title=" + title + "&isAllDay=" + isallday, true);
            xmlhttp.send();
        }
    </script>
</head>
<!-- body start -->
<body>
<!-- Page Preloder -->
<div id="preloder">
    <div class="loader"></div>
</div>
<!-- Page Preloder end -->
<!-- Header section -->
<header class="header-section">
    <div class="container">
        <!-- logo -->
        <a class="site-logo" href="{% url 'index' %}" style="padding-top: 0" title="返回首页">
            <img src="{% static 'img/favicon.ico' %}" alt="返回首页" height="40" width="40">
        </a>
        <a style="font-size: 40px;color: orange;padding-left: 20px" href="{% url 'index' %}" title="返回首页">Six-Single-Dogs</a>
        <div class="user-panel">
            {% if has_login %}
                <a href="{% url 'logout' %}" style="font-size: 20px;color: white">
                    {{ "登出" }}
                </a>
            {% else %}
                <a href="{% url 'login' %}" style="font-size: 20px;color: white">
                    {{ "登录" }}
                </a>
                <a href="{% url 'register' %}" style="color: white;font-size: 20px"> / 注册</a>
            {% endif %}
        </div>
        <!-- responsive -->
        <div class="nav-switch">
            <i class="fa fa-bars"></i>
        </div>
        <!-- site menu -->
        <nav class="main-menu">
            <ul>
                <li><a href="{% url 'index' %}" style="font-size: 20px;color: orange">首页</a></li>
                <li><a href="{% url 'history' %}" style="font-size: 20px;color: orange">历史天气</a></li>
            </ul>
        </nav>
    </div>
</header>
<!-- Header section end -->
<!-- hao123 section start -->
<div class="page-layer status-day">
    <div class="header-layer">
        <div class="weather-info-layer">
            <form action="{% url 'index' %}" method="GET" style="padding-top: 10px">
                {% if has_login %}
                    <span style="font-size: 25px;color: orange">欢迎您，{{ login_user_name }}</span>
                {% endif %}
                <label style="float: right">
                    <select id="choosecity" type="text" name="CITY"
                            onChange="showcity(this.value);changechart(this.value)"
                            style="width: auto;height: 27px;font-size: 25px;color: orange;background: none">
                        <option value="beijing" style="background-color: #FFEFD5" selected>北京</option>
                        <option value="zhengzhou" style="background-color: #FFEFD5">郑州</option>
                        <option value="longyan" style="background-color: #FFEFD5">龙岩</option>
                        <option value="tianjin" style="background-color: #FFEFD5">天津</option>
                        <option value="fengcheng" style="background-color: #FFEFD5">丰城</option>
                        <option value="xiangyang" style="background-color: #FFEFD5">襄阳</option>
                        <option value="hailar" style="background-color: #FFEFD5">海拉尔</option>
                    </select>
                </label>
            </form>
            <div class="weather-info-inner">
                <div class="real-time-box">
                    {#                    图标一#}
                    <div id="todayicon"></div>
                    <div class="text"><span id="selectcity" style="font-size: 35px">北京</span><span class="label">&nbsp;今日天气</span>
                        <div class="temperature">
                            <span class="num" id="today"></span>
                            <span class="symbol">℃</span>
                        </div>
                        <div class="others">
                            <div class="line-1"><span id="today_weather"></span></div>
                        </div>
                    </div>
                </div>
                <div class="forecast-box">
                    <div class="forecast-item">
                        <div class="info">
                            {#                            图标二#}
                            <div id="tomorrowicon"><i class="icon-date ming"></i></div>
                            <div class="temp">
                                <span class="num" id="tomorrow"></span>
                                <span class="symbol">℃</span>
                            </div>
                        </div>
                        <div class="text"><span id="tomorrow_weather"></span></div>
                    </div>
                    <div class="forecast-item last">
                        <div class="info">
                            {#                            图标三#}
                            <div id="nexttomorrowicon"><i class="icon-date hou"></i></div>
                            <div class="temp">
                                <span class="num" id="nexttomorrow"></span>
                                <span class="symbol">℃</span>
                            </div>
                        </div>
                        <div class="text"><span id="nexttomorrow_weather"></span></div>
                    </div>
                </div>
                <div class="fifteen-days-box">
                    <div class="slide-layer">
                        <div class="slide-inner">
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_0" style="font-size: 18px"></span>
                                </div>
                                <div class="weather"><span class="text" id="date_0_weather"
                                                           style="font-size: 18px "></span><i
                                        class="icon-air icon-air-1" ></i>
                                </div>
                            </div>
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_1" style="font-size: 18px"></span>
                                </div>
                                <div class="weather"><span class="text" id="date_1_weather"
                                                           style="font-size: 18px"></span><i
                                        class="icon-air icon-air-1"></i>
                                </div>
                            </div>
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_2" style="font-size: 18px"></span>
                                </div>
                                <div class="weather"><span class="text" id="date_2_weather"
                                                           style="font-size: 18px"></span><i
                                        class="icon-air icon-air-1"></i>
                                </div>
                            </div>
                            <div class="slide-item">
                                <div class="temp">
                                    <span id="date_3" style="font-size: 18px"></span>
                                </div>
                                <div class="weather"><span class="text" id="date_3_weather"
                                                           style="font-size: 18px"></span><i
                                        class="icon-air icon-air-1"></i>
                                </div>
                            </div>
                        </div>
                        <a href="javascript:" class="prev"></a><a href="javascript:" class="next"></a></div>
                    <a id="weather_url" class="label"  target="_blank">
                        <div class="text">15日天气</div>
                    </a></div>
                <div class="data-source">数据来自Six-Single-Dogs天气预测系统</div>
            </div>
        </div>
    </div>
</div>
<!-- hao123 section end -->
<!-- Latest news section -->

<div class="latest-news-section">
    <div class="ln-title" style="font-size: 30px;padding-top: 23px">当日天气</div>
    <div class="news-ticker">
        <div class="news-ticker-contant" onload="hh()">
            <div class="nt-item" style="font-size: 20px"><span class="new" style="font-size: 20px">北京
            </span>{{ queryset.values.0.tmin|floatformat:0 }}
                / {{ queryset.values.0.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.0.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="strategy" style="font-size: 20px">天津
            </span>{{ queryset.values.4.tmin|floatformat:0 }}
                / {{ queryset.values.4.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.4.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="strategy" style="font-size: 20px">丰城
            </span>{{ queryset.values.1.tmin|floatformat:0 }}
                / {{ queryset.values.1.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.1.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="racing" style="font-size: 20px">襄阳
            </span>{{ queryset.values.5.tmin|floatformat:0 }}
                / {{ queryset.values.5.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.5.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="new" style="font-size: 20px">龙岩
            </span>{{ queryset.values.3.tmin|floatformat:0 }}
                / {{ queryset.values.3.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.3.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="strategy" style="font-size: 20px">郑州
            </span>{{ queryset.values.6.tmin|floatformat:0 }}
                / {{ queryset.values.6.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.0.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="nt-item" style="font-size: 20px"><span class="racing" style="font-size: 20px">海拉尔
            </span>{{ queryset.values.2.tmin|floatformat:0 }}
                / {{ queryset.values.2.tmax|floatformat:0 }}℃&nbsp;{{ queryset.values.2.weather }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
        </div>
    </div>
</div>

<!-- Latest news section end -->
<!-- ECharts图表 -->
<!--为ECharts准备一个具备大小的Dom-->
<div id="main" style="background:url({% static 'img/pattern.png' %});width: 100%;height: 80%;"></div>
<script type="text/javascript">
    //获取数据
    var city = "";
    var xarr = [];
    var yarrtmax = [];
    var yarrtmin = [];
    var yarrtavg = [];
    var tenyearx = [];
    var tenyeartmax = [];
    var tenyeartmin = [];
    var tenyeartavg = [];

    function changechart(str) {
        xarr = [];
        yarrtmax = [];
        yarrtmin = [];
        yarrtavg = [];
        tenyearx = [];
        tenyeartmax = [];
        tenyeartmin = [];
        tenyeartavg = [];

        var xmlhttp;
        if (str == "") {
            alert("下拉选项空值异常");
            return;
        }
        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var jsonObj;
                var s = xmlhttp.responseText;
                var myobj = eval(s);
                var currentDateLong = new Date('{{ predict_queryset.0.date|safe }}'.replace(new RegExp("-", "gm"), "/")).getTime();
                for (i = 0; i < myobj.length; i++) {
                    var DateLong = new Date(myobj[i].fields.date.replace(new RegExp("-", "gm"), "/")).getTime()
                    if (DateLong <= currentDateLong) {
                        tenyearx.push(myobj[i].fields.date);
                        tenyeartmax.push(myobj[i].fields.tmax);
                        tenyeartmin.push(myobj[i].fields.tmin);
                        tenyeartavg.push(myobj[i].fields.tavg);
                    }
                    if (DateLong >= currentDateLong) {
                        {#                            alert(i);#}
                        xarr.push(myobj[i].fields.date);
                        yarrtmax.push(parseInt(myobj[i].fields.tmax));
                        yarrtmin.push(parseInt(myobj[i].fields.tmin));
                        yarrtavg.push(parseInt(myobj[i].fields.tavg));
                    }
                }
                var obj = document.getElementById("choosecity");
                var city = obj.options[obj.selectedIndex].value;
                // 指定图表的配置项和数据
                var colors = ['red', '#5793f3', '#ffb320', 'orange', 'white', 'pink'];
                // 基于准备好的dom，初始化echarts实例
                var myChart = echarts.init(document.getElementById('main'));
                myChart.showLoading();
                var option = {
                    baseOption: {
                        timeline: {
                            axisType: 'category',
                            autoPlay: true,
                            // currentIndex: 2,
                            playInterval: 5000,
                            lineStyle: {
                                color: colors[0],
                            },
                            controlStyle: {
                                color: colors[0],
                                borderColor: colors[0],
                                borderWidth: 2,
                            },
                            label: {
                                color: 'yellow',
                            },
                            data: [
                                '未来一周',
                                {
                                    value: '往年今日',
                                    symbol: 'diamond',
                                    symbolSize: 20
                                },
                            ],
                        },
                        title: {
                            left: '10%',
                            top: '1%',
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross'
                            },
                            right: '20%',
                            top: '3%',
                        },
                        calculable: true,
                        grid: {
                            left: '8%',
                            right: '8%',
                            bottom: '10%',
                            containLabel: true
                        },
                        toolbox: {
                            color: colors[0],
                            show: true,
                            right: '10%',
                            top: '3%',
                            feature: {
                                dataZoom: {
                                    yAxisIndex: 'none'
                                },
                                dataView: {readOnly: false},
                                magicType: {type: ['line', 'bar']},
                                restore: {},
                                saveAsImage: {},
                            },
                            iconStyle: {
                                normal: {
                                    color: colors[5],//设置颜色
                                }
                            }
                        },
                        xAxis: [
                            {
                                'type': 'category',
                                'axisLabel': {
                                    {#                        'interval': 0,#}
                                    onZero: false,
                                },
                                splitLine: {show: false}
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value',
                                boundaryGap: false,
                                axisTick: {
                                    alignWithLabel: true
                                },
                                axisLine: {
                                    onZero: false,
                                    lineStyle: {
                                        color: colors[2]
                                    }
                                },
                                min: function (value) {
                                    return value.min - 10;
                                },
                                max: function (value) {
                                    return value.max + 10;
                                }
                            }
                        ],
                    },
                    options: [
                        {
                            legend: {
                                top: '3%',
                                color: colors[2],
                                textStyle: {
                                    fontSize: 18,
                                    color: colors[2]
                                },
                                data: ['最高温度', '平均温度', '最低温度'],
                                selected: {
                                    '最高温度': true, '最低温度': true, '平均温度': true,
                                },
                            },
                            title: {
                                text: '未来一周',
                                textStyle: {
                                    color: colors[2],
                                },
                            },
                            xAxis: [
                                {
                                    'data': xarr,
                                    axisLine: {
                                        lineStyle: {
                                            color: colors[2]
                                        }
                                    },
                                }
                            ],
                            yAxis: [
                                {
                                    axisLine: {
                                        onZero: false,
                                        lineStyle: {
                                            color: colors[2]
                                        }
                                    },
                                }
                            ],
                            series: [
                                {
                                    name: '最高温度',
                                    type: 'line',
                                    color: colors[0],
                                    lineStyle: {
                                        color: colors[0],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: yarrtmax,
                                }, {
                                    name: '平均温度',
                                    type: 'line',
                                    smooth: true,
                                    color: colors[2],
                                    lineStyle: {
                                        color: colors[2],
                                        width: 4,
                                    },
                                    data: yarrtavg,
                                },
                                {
                                    name: '最低温度',
                                    type: 'line',
                                    color: colors[1],
                                    lineStyle: {
                                        color: colors[1],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: yarrtmin,
                                },

                            ]
                        },
                        {
                            legend: {
                                top: '3%',
                                color: colors[1],
                                textStyle: {
                                    fontSize: 18,
                                    color: colors[1]
                                },
                                data: ['最高温度', '平均温度', '最低温度'],
                                selected: {
                                    '最高温度': true, '最低温度': true, '平均温度': true,
                                },
                            },
                            title: {
                                text: '往年今日',
                                textStyle: {
                                    color: colors[1],
                                },
                            },
                            xAxis: [
                                {
                                    'data': tenyearx,
                                    axisLine: {
                                        lineStyle: {
                                            color: colors[1]
                                        }
                                    },
                                }
                            ],
                            yAxis: [
                                {
                                    axisLine: {
                                        onZero: false,
                                        lineStyle: {
                                            color: colors[1]
                                        }
                                    },
                                }
                            ],
                            series: [
                                {
                                    name: '最高温度',
                                    type: 'line',
                                    color: colors[0],
                                    lineStyle: {
                                        color: colors[0],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: tenyeartmax,
                                },
                                {
                                    name: '最低温度',
                                    type: 'line',
                                    color: colors[1],
                                    lineStyle: {
                                        color: colors[1],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: tenyeartmin,
                                },
                                {
                                    name: '平均温度',
                                    type: 'line',
                                    color: colors[2],
                                    lineStyle: {
                                        color: colors[2],
                                        width: 4,
                                    },
                                    smooth: true,
                                    data: tenyeartavg,
                                },
                            ]
                        },
                    ]
                };
                myChart.hideLoading();
                // 使用刚指定的配置项和数据显示图表。
                myChart.setOption(option);

            }
        }
        xmlhttp.open("GET", "/app/changechart?city=" + str, true);
        xmlhttp.send();
    }
</script>
<!-- ECharts图表 end -->
<!-- 日程表 -->
<article style="background: url({% static 'img/pattern.png' %})">
    <p style="font-size: 40px;color: orange;text-align: center;"><b>日程表</b></p>
    <div id="myId3" class="jalendar mid">
        {#        <div class="added-event" data-date="10/7/2020" data-time="All day"#}
        {#             data-title="事件1"></div>#}
        {#        <div class="added-event" data-date="10/7/2020" data-time="20:45"#}
        {#             data-title="事件2"></div>#}
    </div>
</article>
<!-- 日程表 end -->
<!-- Footer top section -->
<section class="footer-top-section">
    <p style="text-align: center;color: #ffa500;font-size: 50px">Six-Single-Dogs</p>
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-6">
                <div class="footer-widget">
                    <h4 class="fw-title" style="font-size: 20px">小组程猿</h4>
                    <div class="top-comment">
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/1.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">胡江浩</a> <span style="font-size: 15px">单身待嫁</span>
                                </p>
                                <div class="tc-date">May&nbsp;3&nbsp;,2000</div>
                            </div>
                        </div>
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/2.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">陈付鑫</a> <span style="font-size: 15px">游戏狂魔</span>
                                </p>
                                <div class="tc-date">February&nbsp;29&nbsp;,2000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="footer-widget">
                    <h4 class="fw-title" style="font-size: 20px">小组程猿</h4>
                    <div class="top-comment">
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/3.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">陈庆洋</a> <span style="font-size: 15px">天才少年</span>
                                </p>
                                <div class="tc-date">May&nbsp;14&nbsp;,1999</div>
                            </div>
                        </div>
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/4.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">邓硕</a> <span style="font-size: 15px">内蒙大汉</span>
                                </p>
                                <div class="tc-date">July&nbsp;18&nbsp;,2000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="footer-widget">
                    <h4 class="fw-title" style="font-size: 20px">小组程猿</h4>
                    <div class="top-comment">
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/5.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">黄俊雯</a> <span style="font-size: 15px">快乐小伙</span>
                                </p>
                                <div class="tc-date">October&nbsp;29&nbsp;,2000</div>
                            </div>
                        </div>
                        <div class="tc-item">
                            <div class="tc-thumb set-bg" data-setbg="{% static 'img/authors/6.jpg' %}"></div>
                            <div class="tc-content">
                                <p><a href="#" style="font-size: 15px">黄琳棠</a> <span style="font-size: 15px">大龄剩男</span>
                                </p>
                                <div class="tc-date">May&nbsp;18&nbsp;,2000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Footer top section end -->
<!-- Footer section -->
<footer class="footer-section">
    <div class="container">
        <ul class="footer-menu">
            <li><a href="{% url 'index' %}">首页</a></li>
            <li><a href="{% url 'history' %}">历史天气</a></li>
        </ul>
        <p class="copyright"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear().toString());</script>
            All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a
                    href="https://colorlib.com" target="_blank">Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
        </p>
    </div>
</footer>
<script src="https://blog-static.cnblogs.com/files/zouwangblog/mouse-click.js"></script>
<canvas width="1777" height="841" style="position: fixed; left: 0px; top: 0px; z-index: 2147483647; pointer-events: none;"></canvas>
<!-- Footer section end -->
<!-- MUSIC -->
<link href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.css">
<script src="https://blog-static.cnblogs.com/files/zouwangblog/APlayer.min.js"></script>
<script src="https://unpkg.com/meting@1.2/dist/Meting.min.js"></script>
<div id="aplayer"></div>
<script>
    const ap = new APlayer({container: document.getElementById('aplayer'),fixed: true,volume: 0.3, mutex: true, order: 'random', preload: 'none', listFolded: false, theme: '#ee8243',
        audio: [{
            name: '想说',           //歌曲名称
            artist: '颜人中',       //歌曲作者
            url: 'http://music.163.com/song/media/outer/url?id=1461142410.mp3',         //歌曲源文件地址
            cover: 'http://p2.music.126.net/_P62J8rc2wRIzoqIJGu2LA==/109951165120360797.jpg',     //歌曲封面地址
            lrc: 'http://music.163.com/api/song/media?id=1461142410',
            theme: '#eeeeee',        //主题颜色（优先）
        },{
            name: 'Come and Get Your Love',
            artist: 'Redbone',
            url: 'http://music.163.com/song/media/outer/url?id=28864241.mp3',
            cover: 'http://p2.music.126.net/5i5SKVW_F1ub2BgDeyjI5A==/3225967119049341.jpg',
            theme: '#eeeeee'
        },{
            name: '大自然的空气(钢琴曲)',
            artist: '张宇桦 ',
            url: 'http://music.163.com/song/media/outer/url?id=33715186.mp3',
            cover: 'http://p1.music.126.net/hHUh5x19WtlcDLM8PAvLTA==/109951164274022050.jpg',
            theme: '#eeeeee'
        },{
            name: '我爱你北京交大',
            artist: ' 高歌  ',
            url: 'http://music.163.com/song/media/outer/url?id=484635685.mp3',
            cover: 'http://p2.music.126.net/Jco3u7spW8YHBT6r8sfhng==/109951162950253373.jpg',
            theme: '#eeeeee'
        },{
            name: '大田後生仔（欢乐加速版）',
            artist: ' 1610877109 ',
            url: 'http://music.163.com/song/media/outer/url?id=1396973729.mp3',
            cover: 'http://p1.music.126.net/zBSqcj15lxJ0vdoSAkh63Q==/109951164427560286.jpg',
            theme: '#eeeeee'
        },
        ]
    });
</script>
<!-- MUSIC end -->

<!--====== Javascripts & Jquery ======-->
<script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<script src="{% static 'js/jquery.marquee.min.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>
<script src="{% static 'js/jalendar.js' %}"></script>
</body>
<script>
    var obj = document.getElementById("choosecity");
    window.onload = showcity(obj.options[obj.selectedIndex].value);
    window.onload = changechart(obj.options[obj.selectedIndex].value);
    window.onload = getcalendar('{{ login_user_name }}');
</script>
</html>